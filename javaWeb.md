## web请求过程

### 发起一个http请求的过程就是建立一个socket通信的过程，只不过outputStreamWriter写的二进制字节数据格式要符合HTTP要求

### http Header控制着用户浏览器恶渲染行为和服务器的执行逻辑
  - 常见的http请求头
    - Accept-Charset: 用于指定客户端接收的字符集
    - Accept-Encoding: 可接受的内容编码
    - Accept-Language: 指定一种自然语言
    - Host: 被请求资源的主机和端口
    - User-Agent: 客户端自己的操作系统，浏览器和其他属性
    - Connection: 当前连接是否保持
  - 常见的http响应头
    - server: 服务器名
    - Content-Type: 响应实体正文的媒体类型
    - Content-Encoding: 与Accept-Encoding对应
    - Content-Language: 与Accept-Language对应
    - Content-Length: 实体正文的长度（以字节方式存储的10进制数的长度）
    - Keep-Alive: 保持连接的时间
  - 常见的http状态码
    - 200: 请求成功
    - 302: 临时跳转，location指定
    - 400: 请求有语法错误，服务器不能识别
    - 403: 服务器收到请求，但是拒绝提供服务
    - 404: 请求的资源不存在
    - 500: 服务器发生不可预测的错误

### 通常使用Cache-Control来进行缓存设置
  - Public: 响应头设置，所有内容都会被缓存
  - Private: 响应头设置，内容只缓存到私有缓存中
  - no-cache: 双边设置，所有内容都不会被缓存
  - no-store: 响应头设置，所有内容都不会被缓存到缓存或internet临时文件中
  - must-revalidation/proxy-revalidation: 请求头设置，如果缓存的内容失效，请求必须发送到服务器/代理服务器以进行重新验证
  - max-age=xxx: 响应头中设置，缓存的内容将在xxx秒后失效

### 我们通过DNS服务来进行域名的简析
  1. 检查浏览器缓存（缓存时间通过TTL属性来设置）
  2. 检查操作系统缓存（就是host文件）
  3. 发送请求给本地DNS服务器请求域名解析（ipconfig里，这个服务器也就是通常所说的SPA）
  4. 访问gTLD，获得对应关系返回给本地DNS服务器

### JVM也会缓存DNS解析结果，会以成功解析和失败解析两种状态记录缓存，通过InetAddress类来完成

### 域名解析记录
  - A记录：用来指定域名对应的IP地址
  - MX记录：用来指定邮件转发服务
  - CNAME记录：别名解析，为一个域名设置一个或多个别名
  - NS记录：用来指定域名对应的指定DNS服务器IP
  - TXT记录：为某个主机或域名设置说明

### CDN内容分布网络，主要以缓存网络中的静态资源为主，通过镜像技术、缓存、整体负载均衡技术提高用户访问网站的响应速度

### 负载均衡技术
  - 链路负载均衡：通过DNS解析成不同的IP，然后根据这个IP来访问不同的服务器（CDN服务）
    - 优点：直接访问目标服务器，不需要代理
    - 缺点：难以及时更新用户的域名解析结构
  - 集群负载均衡（web服务，分布式服务主要内容）
    - 硬件负载均衡：使用硬件设备来转发请求（如F5）
      - 优点：性能棒
      - 缺点：死贵
    - 软件负载均衡：通过将请求进行多次转发最终到达服务器来进行
      - 优点：便宜
      - 缺点：网络延时会有所增加
  - 操作系统负载均衡：通过操作系统级别的软中断或者硬件终端来达到负载均衡的目的，如多队列网卡。

### CDN动态加速，在dns解析中通过动态的链路探测找到CDN中回源最好的一条链路 